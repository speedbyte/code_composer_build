/*-----------------------------------------------------------------------------+
|            ____    ___            ____    _____           ____               |
|           |    |  |   \   |      |    |     |    |    |  |                   |
|           |____|  |    |  |      |____|     |    |    |  |____               |
|           |    |  |    |  |      |    |     |    |    |       |              |
|           |    |  |___/   |____  |    |     |    |____|   ____|              |
|                                                                              |
|           T H E   S M A R T   E M B E D D E D   S O L U T I O N              |
|                                                                              |
+------------------------------------------------------------------------------+
| F I L E   I N F O R M A T I O N                                              |
+------------------------------------------------------------------------------+
|                                                                              |
|  Filename:  ADLATUS_ConfigSystem.c                                           |
|                                                                              |
|  Comment:   This file includes the complete configuration for the            |
|             SMART ADLATUS system.                                            |
|                                                                              |
+------------------------------------------------------------------------------+
| R E V I S I O N   H I S T O R Y                                              |
+------------------------------------------------------------------------------+
|
| Subversion Info:
| $Id: ADLATUS_ConfigSystem.c 4396 2008-11-04 09:26:32Z maennel $
| $HeadURL: http://smartsvn/svn/adlatusrepository/auslieferungen/S1NN/086350-S1NN-ADLATUS-TMS470R-MucSuc/20081201_S1NN_TMS470R_BlfIso-Source_V1.00/01_SW_Projekt/08_corelib/02_src/ADLATUS_ConfigSystem.c $
|
+------------------------------------------------------------------------------+
|      (c) SMART ELECTRONIC DEVELOPMENT GMBH - all rights reserved             |
+-----------------------------------------------------------------------------*/

/* ========================================================================== */
/* (1)  I N C L U D E S                                                       */
/* -------------------------------------------------------------------------- */
/*      C O N S T A N T   D E F I N I T I O N   F I L E S  (CDF)              */
/* ========================================================================== */
#include "ADLATUS_CompilerSwitches_cdf.h"    /* must be the first CDF-include */
#include "ADLATUS_Global_cdf.h"
#include "ADLATUS_ConfigSystem_cdf.h"
#include "ADLATUS_CanHandler_cdf.h"

/* ========================================================================== */
/* (2)  I N C L U D E S                                                       */
/* -------------------------------------------------------------------------- */
/*      T Y P E   D E F I N I T I O N   F I L E S  (TDF)                      */
/* ========================================================================== */
#include "ADLATUS_Types_tdf.h"         /* must be the first include           */
#include "ADLATUS_Setup_tdf.h"         /* Error handling                      */

/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Includes for the communication stack                                       */
#include "ADLATUS_ServiceHandler_tdf.h"   /* Layer 3                          */
#include "ADLATUS_SessionHandler_tdf.h"   /* Layer 2                          */
#include "ADLATUS_Tp_tdf.h"               /* Layer 1                          */
#include "ADLATUS_CanHandler_tdf.h"       /* Layer 0                          */

/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Includes for the Event Handling                                            */
#include "ADLATUS_EventHandlerAudi_tdf.h" /* Event Handler VW                 */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Includes for the Watchdog Trigger Handling                                 */
#include "ADLATUS_ExternalWatchdog_tdf.h" /* Ext Watchdog trigger             */
#include "ADLATUS_HAL_tdf.h"              /* Int Watchdog Trigger             */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Includes for the KWP2000 Timers                                            */
#include "ADLATUS_KWP2000Audi_tdf.h"      /* KWP2000                          */



/* ========================================================================== */
/* (3)  C O M P I L E R   S W I T C H   S E T T I N G S                       */
/* -------------------------------------------------------------------------- */
/*      O N L Y   F O R   T H I S   M O D U L                                 */
/* ========================================================================== */
/* Global Compiler switch settings are done at ADLATUS_CompilerSwitches_CDF.h */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Local compiler switches: No Entry                                          */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */

/* ========================================================================== */
/* (4)  D A T A   S E C T I O N   D I R E C T I V E S                         */
/* -------------------------------------------------------------------------- */
/*      O N L Y   F O R   T H I S   M O D U L                                 */
/* ========================================================================== */
/* NO ENTRY                                                                   */

/* ========================================================================== */
/* (5)  L O C A L   D E F I N E S                                             */
/* -------------------------------------------------------------------------- */
/*      O N L Y   F O R   T H I S   M O D U L                                 */
/* ========================================================================== */
/* NO ENTRY                                                                   */

/* ========================================================================== */
/* (6)  L O C A L  T Y P E   D E F I N E S                                    */
/* -------------------------------------------------------------------------- */
/*      O N L Y   F O R   T H I S   M O D U L                                 */
/* ========================================================================== */
/* NO ENTRY                                                                   */

/* ========================================================================== */
/* (7)  L O C A L   V A R I A B L E S  / C O N S T A N T S                    */
/* -------------------------------------------------------------------------- */
/*      O N L Y   F O R   T H I S   M O D U L                                 */
/* ========================================================================== */



/******************************************************************************/
/******************************************************************************/
/**                                                                          **/
/**     APPLICATION AREA  Buf.01                                             **/
/**     ----------------------------------------------------------------     **/
/**     S Y S T E M   C O N F I G U R A T I O N                              **/
/**     ----------------------------------------------------------------     **/
/**     System Buffer allocation                                             **/
/**                                                                          **/
/**             ----------------------------------------------               **/
/**                                                                          **/
/**                           Application Layer                              **/
/**                                                                          **/
/**        +--> Rx Input Buffer               Tx Output Buffer <--+          **/
/**   (==) |    ----------------------------------------------    | (==)     **/
/**        +--> Rx Output Buffer              Tx Input Buffer  <--+          **/
/**                                                                          **/
/**                              SessionLayer                                **/
/**                                                                          **/
/**        +--> Rx Input Buffer               Tx Output Buffer <--+          **/
/**   (==) |    ----------------------------------------------    | (==)     **/
/**        +--> Rx Output Buffer              Tx Input Buffer  <--+          **/
/**                                                                          **/
/**                                TP Layer                                  **/
/**                                                                          **/
/**        +--> Rx Input Buffer               Tx Output Buffer <--+          **/
/**   (==) |    ----------------------------------------------    | (==)     **/
/**        +--> Rx Output Buffer              Tx Input Buffer  <--+          **/
/**                                                                          **/
/**                             Physical Layer                               **/
/**                                                                          **/
/**        - - - - - - - - - - - - - - - - - - - - - - - - - - - -           **/
/**                                                                          **/
/******************************************************************************/
/******************************************************************************/

/* -------------------------------------------------------------------------- */
/*   Session - Application Buffer                                             */
/* -------------------------------------------------------------------------- */
/* Buffer for channel 00                                                      */
BUFFER_UB g_RxWorkBuffer00_BUF[(0x04 + d_CCconsys_RxWorkBufferLength00)];
BUFFER_UB g_TxWorkBuffer00_BUF[(0x04 + d_CCconsys_TxWorkBufferLength00)];
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/
/* Buffer for channel 01                                                      */
/* ... NoEntry                                                                */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* -------------------------------------------------------------------------- */
/*   TP - Session Buffer                                                      */
/* -------------------------------------------------------------------------- */
/* Buffer for channel 00                                                      */
BUFFER_UB g_RxBuffer00_BUF [(0x04 + d_CCconsys_RxBufferLength00)];
BUFFER_UB g_TxBuffer00_BUF [(0x04 + d_CCconsys_TxBufferLength00)];
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/
/* Buffer for channel 01                                                      */
/* ... NoEntry                                                                */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* -------------------------------------------------------------------------- */
/*   HAL - TP Buffer                                                          */
/* -------------------------------------------------------------------------- */
/* Buffer for channel 00                                                      */
BUFFER_UB g_RxMsgObj00_BUF[(4 + d_CCconsys_RxHalBuffer00)];
BUFFER_UB g_TxMsgObj00_BUF[(4 + d_CCconsys_TxHalBuffer00)];
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/
/* Buffer for channel 01                                                      */
/* ... NoEntry                                                                */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

BUFFER_UB g_CCdp_WorkingBuffer_BUF[0x06 + d_CCconsys_RxWorkBufferLength00];

/******************************************************************************/
/* -- -- END OF APPLICATION AREA   Buf.01  - -- -- -- -- -- -- -- -- -- -- -- */
/******************************************************************************/


/******************************************************************************/
/******************************************************************************/
/**                                                                          **/
/**     APPLICATION AREA   Buf.02                                            **/
/**     ----------------------------------------------------------------     **/
/**     S Y S T E M   C O N F I G U R A T I O N                              **/
/**     ----------------------------------------------------------------     **/
/**     Global System Buffer Configuration                                   **/
/**                                                                          **/
/******************************************************************************/
/******************************************************************************/

const BUFFERCONFIGURATION_ST c_CCconsys_BufferConfig_AST[d_CCconsys_NbrOfLogChannel] = \
{
  /*    ++-----------------------------------------------------------------++ */
  /*    ||                                                                 || */
  /*    ||  CHANNEL 00                                                     || */
  /*    ||                                                                 || */
  /*    ++--------------------------------+--------------------------------++ */
  /*    ||  Ptr to Buffer                 |   Ptr to Buffer                || */
  /*    ++--------------------------------+--------------------------------++ */
  {
  /*    ++--------------------------------+--------------------------------++ */
  /*    ||   PHYSICAL LAYER Rx            |  PHYSICAL LAYER Tx             || */
  /*    ++--------------------------------+--------------------------------++ */
  /* 00 */{  g_RxMsgObj00_BUF,
  /* 01 */                                   g_TxMsgObj00_BUF ,
  /*    ++--------------------------------+--------------------------------++ */
  /*    ||  TRANSPORT LAYER Rx            |  TRANSPORT LAYER Tx            || */
  /*    ++--------------------------------+--------------------------------++ */
  /* 02 */   g_RxBuffer00_BUF,
  /* 03 */                                   g_TxBuffer00_BUF ,
  /*    ++--------------------------------+--------------------------------++ */
  /*    ||  SESSION LAYER Rx              |   SESSION LAYER Tx             || */
  /*    ++--------------------------------+--------------------------------++ */
  /* 04 */   g_RxWorkBuffer00_BUF,
  /* 05 */                                   g_TxWorkBuffer00_BUF }
  /*    ++--------------------------------+--------------------------------++ */
  /*    ||  APPLICATION LAYER Rx          |  APPLICATION LAYER Tx          || */
  /*    ++--------------------------------+--------------------------------++ */
  }
}; /*-+- END OF TABLE -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+*/

/******************************************************************************/
/* -- -- END OF APPLICATION AREA  Buf.02  -- -- -- -- -- -- -- -- -- -- -- -- */
/******************************************************************************/


/******************************************************************************/
/******************************************************************************/
/**                                                                          **/
/**     APPLICATION AREA   Buf.03                                            **/
/**     ----------------------------------------------------------------     **/
/**     S Y S T E M   C O N F I G U R A T I O N                              **/
/**     ----------------------------------------------------------------     **/
/**     Buffer initialisation                                                **/
/**                                                                          **/
/******************************************************************************/
/******************************************************************************/
const BUFFERINIT c_CCcon_BufferInit_ST[d_CCconsys_NbrOfLogChannel][6] =
{
  /*--------------------------------------------------------------------------*/
  /*                                                                          */
  /*  Channel 00                                                              */
  /*                                                                          */
  /*--------------------------------------------------------------------------*/
  {
    /*--------------------------------------------------------------------------*/
    /* 00 - Physical Layer - RxOutBuffer                                        */
    /*--------------------------------------------------------------------------*/
    {
      /* BufferState */ (d_CCglo_BufferInvalid | d_CCglo_BufferIdle | d_CCglo_ReceiverBuffer ),
      /* ChannelInfo */ (d_CCglo_SubSet00 | d_CCglo_Channel00 ),
      /* BufferSize  */  d_CCglo_08Byte,
      /* Current DLC */  0x00
    },
    /*--------------------------------------------------------------------------*/
    /* 01 - Physical Layer - TxInBuffer                                         */
    /*--------------------------------------------------------------------------*/
    {
      /* BufferState */ (d_CCglo_BufferInvalid | d_CCglo_BufferIdle | d_CCglo_TransmitterBuffer ),
      /* ChannelInfo */ (d_CCglo_SubSet01 | d_CCglo_Channel00 ),
      /* BufferSize  */  d_CCglo_08Byte,
      /* Current DLC */  0x00
    },
    /*--------------------------------------------------------------------------*/
    /* 02 - Transport Layer -  RxOutBuffer                                      */
    /*--------------------------------------------------------------------------*/
    {
      /* BufferState */ (d_CCglo_BufferInvalid | d_CCglo_BufferIdle | d_CCglo_ReceiverBuffer ),
      /* ChannelInfo */  d_CCglo_Channel00,
      /* BufferSize  */  d_CCconsys_RxBufferLength00,
      /* Current DLC */  0x00
    },  
    /*--------------------------------------------------------------------------*/
    /* 03 - Transport Layer -  RxInBuffer                                       */
    /*--------------------------------------------------------------------------*/
    {
      /* BufferState */ (d_CCglo_BufferInvalid | d_CCglo_BufferIdle | d_CCglo_TransmitterBuffer ),
      /* ChannelInfo */  d_CCglo_Channel00,
      /* BufferSize  */  d_CCconsys_TxBufferLength00,
      /* Current DLC */  0x00
    }, 
    /*--------------------------------------------------------------------------*/
    /* 04 - Session Layer - RxOutBuffer                                         */
    /*--------------------------------------------------------------------------*/
    {
      /* BufferState */  (d_CCglo_BufferInvalid | d_CCglo_BufferIdle | d_CCglo_ReceiverBuffer ),
      /* ChannelInfo */   d_CCglo_Channel00 ,
      /* BufferSize  */   d_CCconsys_RxWorkBufferLength00,
      /* Current DLC */   0x00
    },  
    /*--------------------------------------------------------------------------*/
    /* 05 - Session Layer - RxInBuffer                                          */
    /*--------------------------------------------------------------------------*/
    /* Session output workbuffer */
    {
      /* BufferState */  (d_CCglo_BufferInvalid | d_CCglo_BufferIdle | d_CCglo_TransmitterBuffer ),
      /* ChannelInfo */   d_CCglo_Channel00,
      /* BufferSize  */   d_CCconsys_TxWorkBufferLength00,
      /* Current DLC */   0x00
    }
  } /* END OF Channel 00 ----------------------------------------------------*/
}; /* --- END OF TABLE -------------------------------------------------------*/

/******************************************************************************/
/* -- -- END OF APPLICATION AREA  Buf.03  -- -- -- -- -- -- -- -- -- -- -- -- */
/******************************************************************************/



/******************************************************************************/
/******************************************************************************/
/**                                                                          **/
/**     APPLICATION AREA   Sys.01                                            **/
/**     ----------------------------------------------------------------     **/
/**     S Y S T E M   C O N F I G U R A T I O N                              **/
/**     ----------------------------------------------------------------     **/
/**     Command Runtime Information                                          **/
/**     (SessionHandler - ServiceHandler - Interface)                        **/
/**                                                                          **/
/******************************************************************************/
/******************************************************************************/

/* -------------------------------------------------------------------------- */
/*   Command Runtime Buffer                                                   */
/* -------------------------------------------------------------------------- */
CMDRUNTIMEINFO_ST CmdRuntimeInfo_AST[d_CCconsys_NbrOfLogChannel];

/******************************************************************************/
/* -- -- END OF APPLICATION AREA   Sys.01  - -- -- -- -- -- -- -- -- -- -- -- */
/******************************************************************************/



/******************************************************************************/
/******************************************************************************/
/**                                                                          **/
/**     APPLICATION AREA   Sys.02                                            **/
/**     ----------------------------------------------------------------     **/
/**     S Y S T E M   C O N F I G U R A T I O N                              **/
/**     ----------------------------------------------------------------     **/
/**     ADLATUS Protocol Stack Configuration                                 **/
/**                                                                          **/
/**                                                                          **/
/******************************************************************************/
/******************************************************************************/
const COMSTACKFUNCTIONS_ST c_CCconsys_ComStackFunctions_AST[d_CCconsys_NbrOfLogChannel] = \
{
  /*--------------------------------------------------------------------------*/
  /* Channel 00 - VW / AUDI Access                                            */
  /*-------------------------+------------------------------------------------*/
  /* Layer Info              | Corresponding function                         */
  /*-------------------------+------------------------------------------------*/
  {
    /* 00 Rx Physical Layer */{  FUN_CCcan_RxData_UB           ,
    /* 01 Tx Physical Layer */   FUN_CCcan_TxData_UB           ,
    /* 02 Rx Tp Layer       */   FUN_CCtp_RxTp_UB              ,
    /* 03 Tx Tp Layer       */   FUN_CCtp_TxTp_UB              ,
    /* 04 Rx Session Layer  */   FUN_CCses_RxSession_UB        ,
    /* 05 Tx Session Layer  */   FUN_CCses_TxSession_UB        ,
    /* 06 Rx Applic. Layer  */   FUN_CCsrv_RxServiceHandler_UB } 
  } /* -+- END OF Channel ----------------------------------------------------*/

}; /* -+- END OF TABLE -------------------------------------------------------*/

/******************************************************************************/
/* -- -- END OF APPLICATION AREA   Sys.02 -- -- -- -- -- -- -- -- -- -- -- -- */
/******************************************************************************/



/******************************************************************************/
/******************************************************************************/
/**                                                                          **/
/**     APPLICATION AREA   Sys.03                                            **/
/**     ----------------------------------------------------------------     **/
/**     S Y S T E M   C O N F I G U R A T I O N                              **/
/**     ----------------------------------------------------------------     **/
/**     ADLATUS Protocol Stack  - HAL Configuration                          **/
/**                                                                          **/
/**                                                                          **/
/******************************************************************************/
/******************************************************************************/
const COMHALFUNCTIONS_ST c_CCconsys_ComHALFunctions_AST[] =
{
  /*--------------------------------------------------------------------------*/
  /* Channel 00 - Communication Interface HAL Function                        */
  /*--------------------------------------------------------------------------*/
  {
    FUN_CCcan_CheckCanReceiver_UB
  } /* -+- END OF Channel ----------------------------------------------------*/

  /*--------------------------------------------------------------------------*/
  /* Channel 01 - Communication Interface HAL Function                        */
  /*--------------------------------------------------------------------------*/
  /* .. NO ENTRY                                                              */

}; /* -+- END OF TABLE -------------------------------------------------------*/

/******************************************************************************/
/* -- -- END OF APPLICATION AREA   Sys.03  - -- -- -- -- -- -- -- -- -- -- -- */
/******************************************************************************/

/******************************************************************************/
/******************************************************************************/
/**                                                                          **/
/**     APPLICATION AREA   Sys.06                                            **/
/**     ----------------------------------------------------------------     **/
/**     S Y S T E M   C O N F I G U R A T I O N                              **/
/**     ----------------------------------------------------------------     **/
/**     Event Handler for different customer access                          **/
/**                                                                          **/
/**                                                                          **/
/******************************************************************************/
/******************************************************************************/
const PTR_TO_EVENTPROCESSING_FKT c_CCconsys_EventProcessingFkt_AST[d_CCconsys_NbrOfLogChannel] = \
{
  /*--------------------------------------------------------------------------*/
  /* Event Handler Routine for Channel 00                                     */
  /*--------------------------------------------------------------------------*/
    FUN_CCeventaudi_EventProcessing_V
  /* -+- END OF Channel ----------------------------------------------------*/

}; /* -+- END OF TABLE -------------------------------------------------------*/


/******************************************************************************/
/* -- -- END OF APPLICATION AREA   Sys.06    -- -- -- -- -- -- -- -- -- -- -- */
/******************************************************************************/



/******************************************************************************/
/******************************************************************************/
/**                                                                          **/
/**     APPLICATION AREA Time.02                                             **/
/**     ----------------------------------------------------------------     **/
/**     S Y S T E M   C O N F I G U R A T I O N                              **/
/**     ----------------------------------------------------------------     **/
/**     Software Timer                                                       **/
/**                                                                          **/
/******************************************************************************/
/******************************************************************************/
const PTR_TO_SWTIMER_FKT c_CCtim_SWTimerFunctions_APFUN[] =
{

  /*==========================================================================*/
  /*                                                                          */
  /* Common SW-Timer                                                          */
  /*                                                                          */
  /*==========================================================================*/

  /*--------------------------------------------------------------------------*/
  /* Common Timer 01 - Extern Watchdog Timer                                  */
  /*--------------------------------------------------------------------------*/
    (PTR_TO_SWTIMER_FKT) FUN_CCwtdog_TriggerExtWatchdog_V, 
  /* -+- END OF Entry --------------------------------------------------------*/

  /*--------------------------------------------------------------------------*/
  /* Common Timer 02 - Internal Watchdog Timer                                */
  /*--------------------------------------------------------------------------*/
    (PTR_TO_SWTIMER_FKT) FUN_CChal_TriggerIntWatchdog_V, 
  /* -+- END OF Entry --------------------------------------------------------*/

  /*==========================================================================*/
  /*                                                                          */
  /* SW-Timer for customer access:                                            */
  /* -----------------------------                                            */
  /* VW                                                                       */
  /*==========================================================================*/
  /*--------------------------------------------------------------------------*/
  /* SW Timer 01 - TP Timer                                                   */
  /*--------------------------------------------------------------------------*/
    (PTR_TO_SWTIMER_FKT) FUN_CCTp_Timer_V,
  /*--------------------------------------------------------------------------*/
  /* SW Timer 02 - Project Timer                                              */
  /*--------------------------------------------------------------------------*/
    (PTR_TO_SWTIMER_FKT) FUN_CCeventaudi_ProjectTimer_V,
  /*--------------------------------------------------------------------------*/
  /* LAST ENTRY - DON'T CHANGE !!!                                            */
  /*--------------------------------------------------------------------------*/
    (PTR_TO_SWTIMER_FKT) 0xFFFFu

}; /* -+- END OF TABLE ---------------------------------------*/ /*l_int !e923 */


/* Time slot in ms */
const UWORD c_CCVhnd_TimeSlot_1ms_UW    = d_CCVhnd_TimeSlot_1ms_UW;
/* Time slot in n*(1ms/0xFF) */
const UBYTE c_CCVhnd_TimeSlot_4us_UB    = d_CCVhnd_TimeSlot_4us_UB;

/******************************************************************************/
/* -- -- END OF APPLICATION AREA   Time.02    -- -- -- -- -- -- -- -- -- -- --*/
/******************************************************************************/


/* ========================================================================== */
/* (8)  L O C A L   F U N C T I O N   P R O T O T Y P E S                     */
/* -------------------------------------------------------------------------- */
/*      O N L Y   F O R   T H I S   M O D U L                                 */
/* ========================================================================== */
/* NO ENTRY                                                                   */

/* ========================================================================== */
/* (9)  G L O B A L   V A R I A B L E S                                       */
/* -------------------------------------------------------------------------- */
/*      D E F I N E D   W I T H I N   T H I S   M O D U L                     */
/* ========================================================================== */
/* NO ENTRY                                                                   */

/* ========================================================================== */
/* (10) F U N C T I O N   D E F I N I T I O N S                               */
/* -------------------------------------------------------------------------- */
/*      F O R   T H I S   M O D U L                                           */
/* ========================================================================== */
/* NO ENTRY                                                                   */

/* ========================================================================== */
/*      E N D   O F   F I L E                                                 */
/* ========================================================================== */
